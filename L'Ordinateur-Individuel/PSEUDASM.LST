29970 REM Atari port by Mark Miller, 2025
29980 REM GOTO 30070 to get hex dump of any address
29990 REM GOSUB 30290 to assemble code in comments
30000 REM May need to CLR before each run
30005 REM From L'Ordinateur Individuel, Dec. 1985 issue
30010 REM Pseudo-Assembler
30020 REM 
30030 REM by Luc Pineau
30040 REM 
30050 REM (c) The Individual Computer
30060 REM and the author
30070 CLS 
30080 REM 
30085 DIM P$(1),A$(1),H$(5),TEMP$(2)
30090 INPUT "Starting address: ";DEP
30100 N=DEP
30110 GOSUB 30240
30120 FOR T=0 TO 7:P=PEEK(DEP+T):N=P:GOSUB 30240:NEXT T
30140 FOR T=0 TO 7:P$=CHR$(PEEK(DEP+T))
30150   IF ASC(P$)<33 OR ASC(P$)>126 THEN P$="."
30160   ? P$;
30165 NEXT T
30167 ? 
30170 DEP=DEP+8
30180 IF INKEY$="E" THEN 30200
30190 GOTO 30100
30200 ? "Different start address (Y/N) ? "
30210 INPUT A$
30212 IF A$="Y" THEN 30090
30214 IF A$="N" THEN CLS :END 
30220 GOTO 30210
30230 END 
30240 REM 
30250 H$=HEX$(N):REM Convert N in hex
30260 IF N<$10 THEN LN=LEN(H$):TEMP$(1,1)="0":TEMP$(2,2)=H$(LN,LN):H$=TEMP$
30270 ? H$;" ";
30280 RETURN 
30290 REM Pseudo-Assembler
30300 *F :DIM L$(4),D$(12),S$(2),C$(4):CM=DPEEK(136)
30310 REM 
30320 CM=CM+4
30330 L$=""
30340 FOR I=1 TO 4
30350   L$(I,I)=CHR$(PEEK(CM+I))
30360 NEXT I
30370 C$=L$:EXEC HTD:L=CVAL
30380 CM=CM+6
30390 IF PEEK(CM)<48 OR PEEK(CM)>70 THEN RETURN 
30400 D$=""
30410 FOR I=0 TO 7:D$(I+1,I+1)=CHR$(PEEK(CM+I)):NEXT I
30420 I=1
30430 FOR E=1 TO 3
30440   S$=D$(I,I+1)
30450   IF S$="  " THEN 30510
30460   IF S$="XX" THEN RETURN 
30470   C$=S$:EXEC HTD:S=CVAL
30480   POKE L,S
30490   I=I+3
30500   L=L+1
30510 NEXT E
30520 CM=CM+26
30530 GOTO 30310
30570 REM HTD
30580 REM Input: C$ - Hex str.
30590 REM Output: CVAL - Decimal val.
30600 PROC HTD
30610   CVAL=0:LN=LEN(C$)
30620   FOR DIG=1 TO LN
30630     VL=ASC(C$(DIG,DIG))
30640     REM Get power of 16 for digit
30650     PLVAL=LN-DIG+1:EXEC EX
30660     REM If digit is A-F
30670     IF VL>=65 AND VL<=70 THEN CVAL=CVAL+(VL-65+10)*FACT:GOTO 30700
30680     REM If digit is 0-9
30690     CVAL=CVAL+FACT*VAL(C$(DIG,DIG))
30700   NEXT DIG
30710 ENDPROC 
30750 REM EX
30760 REM Input: PLVAL - Place value
30770 REM Output: FACT - Power of 16 for place value
30780 PROC EX
30790   FACT=1
30800   IF PLVAL=2 THEN FACT=16
30810   IF PLVAL=3 THEN FACT=256
30820   IF PLVAL=4 THEN FACT=4096
30830 ENDPROC 
